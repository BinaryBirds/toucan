<!DOCTYPE html>
<html >
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Beginner&#39;s guide to server-side Swift using the Hummingbird framework - </title>
    <meta name="description" content="Learn about Swift on the server by creating a simple application using the brand new HTTP server library called: Hummingbird.">
    
    <meta property="og:url" content="/posts/beginners-guide-to-server-side-swift-using-the-hummingbird-framework/">
    <meta property="og:title" content="Beginner&#39;s guide to server-side Swift using the Hummingbird framework - ">
    <meta property="og:description" content="Learn about Swift on the server by creating a simple application using the brand new HTTP server library called: Hummingbird.">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Beginner&#39;s guide to server-side Swift using the Hummingbird framework - ">
    <meta name="twitter:description" content="Learn about Swift on the server by creating a simple application using the brand new HTTP server library called: Hummingbird.">
    
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <link rel="shortcut icon" href="/images/icons/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/images/icons/icon-320.png" type="image/png">
    
    <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon-180x180.png">

</head>

<body>
    <header id="navigation">
        <a id="site-logo" href="">
            <figure>
                <picture>
                    <source
                        srcset="/images/logos/logo~dark.png"
                        media="(prefers-color-scheme: dark)"
                    >
                    <img
                        id="logo-image"
                        src="/images/logos/logo.png"
                        alt="Logo of "
                        title=""
                    >
                </picture>
            </figure>
        </a>
    
        <nav id="primary-menu">
            <input type="checkbox" id="primary-menu-button" name="menu-button" class="menu-button">
            <label for="primary-menu-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </label>
            <div class="menu-items">
                <a href="/">Home</a>
                <a href="/blog/">Blog</a>
                <a href="/posts/pages/1/">Posts</a>
                <a href="/authors/">Authors</a>
                <a href="/tags/">Tags</a>
                <a href="/my-page/">My page</a>
            </div>
        </nav>
    
        <nav id="secondary-menu">
            <input type="checkbox" id="secondary-menu-button" name="menu-button" class="menu-button">
            <label for="secondary-menu-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="1"></circle>
                    <circle cx="12" cy="5" r="1"></circle>
                    <circle cx="12" cy="19" r="1"></circle>
                </svg>
            </label>
            <div class="menu-items right">
                <a href="#">My account</a>
                <a href="/">Logout</a>
            </div>
        </nav>
    </header>
        
    <main>

<article>
    <header>
        <section id="post-header" class="content-wrapper">
            <time datetime="2023-03-08 16:20:00">2023-03-08 16:20:00</time>
            <h1 class="title">Beginner&#39;s guide to server-side Swift using the Hummingbird framework</h1>
            <p class="excerpt">Learn about Swift on the server by creating a simple application using the brand new HTTP server library called: Hummingbird.</p>
        </section>
        
    </header>

    <section id="contents" class="content-wrapper">
    
    <h2>Swift on the Server in 2023</h2><p>Three years ago I started to <a href="https://theswiftdev.com/beginners-guide-to-server-side-swift-using-vapor-4/" target="_blank">focus on Vapor</a>, the most popular web-framework written in Swift, which served me very well over the years, but now it is time to start a new chapter in my life.</p><p>As I learned more and more about how servers work I realized that Vapor has itâ€™s own pros and cons. The community changed a lot during the past 3 years, some core members left and new people started to maintain the framework. I also had some struggles with the default template engine (Leaf) and recently I started to turn away from the abstract database layer (Fluent) too. Another pain point for me is the growing number of dependencies, I barely use websockets & multipart-kit, but Vapor has these dependencies by default and you canâ€™t get rid of them. ðŸ˜¢</p><p>Vapor has some really nice things to offer, and for most of the people itâ€™s still going to be a great choice for building backends for frontends (BFFs). For me, Vapor reached its limits and I wanted to use something that feels a bit lighter. Somethings that is modular, something that can be easily extended and fits my exact needs without additional (unused) package dependencies.</p><p>This shiny new thing is called <a href="https://github.com/hummingbird-project/hummingbird" target="_blank">Hummingbird</a> and it looks very promising. It was created by <a href="https://x.com/o_aberration" target="_blank">Adam Fowler</a> who is a member of the <a href="https://www.swift.org/sswg/" target="_blank">SSWG</a> and also the main author of the <a href="https://github.com/soto-project/soto" target="_blank">Soto library</a> (AWS Swift).</p><p>Hummingbird has a comprehensive <a href="https://hummingbird-project.github.io/hummingbird-docs/documentation/hummingbird/" target="_blank">documentation available online</a> and a nice <a href="https://github.com/hummingbird-project/hummingbird-examples" target="_blank">example repository</a> containing various demo apps written using the Hummingbird Swift server framework. I believe that the best part of the the framework is modularity & extensibility. By the way, Hummingbird works without Foundation, but it has extensions for Foundation objects, this is a huge plus for me, but maybe thatâ€™s just my personal preference nowadays. Hummingbird can be extended easily, you can find some very <a href="https://github.com/hummingbird-project/hummingbird#hummingbird-extensions" target="_blank">useful extensions</a> under the Hummingbird project page, long story short it works with Fluent and itâ€™s relatively easy to get along with it if you have some Vapor knowledgeâ€¦ ðŸ¤”</p><h2>Getting started with Hummingbird</h2><p>First of all, there is no toolbox or command line utility to help the kickoff process, but you can always download the examples repository and use one of the projects as a starting point. Alternatively you can set everything up by hand, thatâ€™s what weâ€™re going to do now. ðŸ”¨</p><p>In order to build a new application using the Hummingbird framework you should create a new directory and initialize a new Swift package using the following commands:</p><pre><code>mkdir server && cd $_
swift package init --type executable
open Package.swift
</code></pre><p>This will create a new Swift package and open the Package.swift file in Xcode. You can use your own editor if you donâ€™t like Xcode, but either way youâ€™ll have to add Hummingbird to your package manifest file as a dependency. Weâ€™re going to setup an App target for the application itself, and a Server target for the main executable, which will use the application and configure it as needed.</p><pre><code class="language-swift">// swift-tools-version: 5.7
import PackageDescription

let package = Package(
    name: "server",
    platforms: [
        .macOS(.v10_15),
    ],
    dependencies: [
        .package(
            url: "https://github.com/hummingbird-project/hummingbird",
            from: "1.0.0"
        ),
        .package(
            url: "https://github.com/apple/swift-argument-parser",
            from: "1.0.0"
        ),
    ],
    targets: [
        .executableTarget(
            name: "Server",
            dependencies: [
                .product(
                    name: "ArgumentParser",
                    package: "swift-argument-parser"
                ),
                .target(name: "App"),
            ]
        ),
        .target(
            name: "App",
            dependencies: [
                .product(
                    name: "Hummingbird",
                    package: "hummingbird"
                ),
                .product(
                    name: "HummingbirdFoundation",
                    package: "hummingbird"
                ),
            ],
            swiftSettings: [
                .unsafeFlags(
                    ["-cross-module-optimization"],
                    .when(configuration: .release)
                ),
            ]
        ),
        .testTarget(
            name: "AppTests",
            dependencies: [
                .product(
                    name: "HummingbirdXCT",
                    package: "hummingbird"
                ),
                .target(name: "App"),
            ]
        ),
    ]
)
</code></pre><p>Please create the necessary file and directory structure, as listed below, before you proceed to the next steps. It is very important to name things as they appear, otherwise SPM wonâ€™t work and the project wonâ€™t compile. Anyway, the project structure is kind-of Vapor-like as you can see. ðŸ’§</p><pre><code>.
â”œâ”€â”€ Package.resolved
â”œâ”€â”€ Package.swift
â”œâ”€â”€ README.md
â”œâ”€â”€ Sources
â”‚ â”œâ”€â”€ App
â”‚ â”‚ â””â”€â”€ HBApplication+Configure.swift
â”‚ â””â”€â”€ Server
â”‚     â””â”€â”€ main.swift
â””â”€â”€ Tests
    â””â”€â”€ AppTests
        â””â”€â”€ AppTests.swift
</code></pre><p>The next step is to create the main entry point for the application. For this purpose Hummingbird uses the <a href="https://github.com/apple/swift-argument-parser" target="_blank">Swift Argument Parser</a> library. Place the following contents into the main.swift file:</p><pre><code class="language-swift">import ArgumentParser
import Hummingbird
import App

struct HummingbirdCommand: ParsableCommand {

    @Option(name: .shortAndLong)
    var hostname: String = "127.0.0.1"

    @Option(name: .shortAndLong)
    var port: Int = 8080

    func run() throws {
        let app = HBApplication(
            configuration: .init(
                address: .hostname(hostname, port: port),
                serverName: "Hummingbird"
            )
        )
        try app.configure()
        try app.start()
        app.wait()
    }
}

HummingbirdCommand.main()
</code></pre><p>The HummingbirdCommand has two options, you can setup a custom hostname and port by providing these values as command line options (Iâ€™ll show it later on), the application itself will setup the address using the input and then itâ€™ll start listening on the specified port.</p><p>The configure method comes from the App target, this is where you can customize your server instance, register route handlers and stuff like that, just like you would do this in Vapor. The main difference is that Hummingbird uses the HB namespace, which is pretty handy, and the configure method is written as an extension. Letâ€™s write it and register a basic route handler. ðŸ§©</p><pre><code class="language-swift">import Hummingbird
import HummingbirdFoundation

public extension HBApplication {

    func configure() throws {

        router.get("/") { _ in
            "Hello, world!"
        }
    }
}
</code></pre><p>Thatâ€™s it. Now you should be able to run your server, you can press the Play button in Xcode thatâ€™ll start your application or enter one of the following commands into the Terminal application:</p><pre><code># just run the server
swift run Server

# custom hostname and port
swift run Server --port 3000
swift run Server --hostname 0.0.0.0 --port 3000

# short version
swift run Server -p 3000
swift run Server -h 0.0.0.0 -p 3000

# set the log level (https://github.com/apple/swift-log#log-levels)
LOG_LEVEL=notice swift run Server -p 3000

# make release build
swift build -c release

# copy release build to the local folder
cp .build/release/Server ./Server

# run the executable
LOG_LEVEL=notice ./Server -p 3000
</code></pre><p>You can set these values in Xcode too, just click on the server scheme and select the Edit Schemeâ€¦ menu item. Make sure that youâ€™re on the Run target, displaying the Arguments tag. Simply provde the Arguments Passed On Launch options to set a custom hostname or port and you can set the log level by adding a new item into the Environment Variables section.</p><p>If youâ€™d like to unit test your application, Iâ€™ve got a good news for you. Hummingbird also comes with a nice utility tool called HummingbirdXCT, which you can easily setup & use if youâ€™d like to run some tests against your API. In our project, simply alter the AppTests.swift file.</p><pre><code class="language-swift">import Hummingbird
import HummingbirdXCT
import XCTest
@testable import App

final class AppTests: XCTestCase {
    
    func testHelloWorld() throws {
        let app = HBApplication(testing: .live)
        try app.configure()

        try app.XCTStart()
        defer { app.XCTStop() }

        try app.XCTExecute(uri: "/", method: .GET) { response in
            XCTAssertEqual(response.status, .ok)

            let expectation = "Hello, world!"
            let res = response.body.map { String(buffer: $0) }
            XCTAssertEqual(res, expectation)
        }
    }
}
</code></pre><p>Instead of creating the application from the main entry point, we can set up a new HBApplication instance, import the App framework and call the configure method on it. the XCT framework comes with a custom XCTStart and XCTStop method, and you can execute HTTP requests using the XCTExecute function. The response is available in a completion block and itâ€™s possible to examine the status code and extract the body using a convenient String initializer.</p><p>As you can see Hummingbird is quite similar to Vapor, but itâ€™s lightweight and you can still add those extra things to your server when it is needed. Hummingbird feels like the next iteration of Vapor. I really donâ€™t know if Vapor 5, is going to fix the issues Iâ€™m currently having with the framework or not, but I donâ€™t really care, because that release wonâ€™t happen anytime soon.</p>
        
    </section>
    
    <h2>Next</h2>
    
    <h2>Prev</h2>
        <div class="post card">
            <a href="/posts/hummingbird-routing-and-requests/" target="">
                <figure>
                    <picture>
                        <img
                            src=""
                            alt=""
                            title=""
                        >
                    </picture>
                </figure>
                <section>
                    <time datetime="2023-03-17 16:20:00">2023-03-17 16:20:00</time>
                    <h2 class="title">Hummingbird routing and requests</h2>
                </section>
                <p>Beginner&#39;s guide to learn all about routing and request handling using the Hummingbird server-side Swift framework.</p>
            </a>
        
            
            
        
        </div>
    
    <h2>Related</h2>
    Empty.
    
    <h2>More by author(s)</h2>
    Empty.

</article>

    </main>

    <footer id="page-footer">
        <section class="content-wrapper">
            <figure>
                <picture>
                    <source
                        srcset="/images/logos/logo~dark.png"
                        media="(prefers-color-scheme: dark)"
                    >
                    <img
                        id="logo-image"
                        src="/images/logos/logo.png"
                        alt="Logo of "
                        title=""
                    >
                </picture>
            </figure>
    
            <p>This site was generated using the <a href="https://swift.org/" target="_blank">Swift</a> programming language.</p>
            
            <p>
                <a href="https://binarybirds.com/">Home</a> Â·
                <a href="mailto:binarybirdsofficial@gmail.com">Email</a> Â·
                <a href="https://github.com/binarybirds/">GitHub</a> Â·
                <a href="https://x.com/tiborbodecs">Twitter</a> Â·
                <a href="/rss.xml" target="_blank">RSS</a> Â·
                <a href="/sitemap.xml" target="_blank">Sitemap</a>
            </p>
    
            <p class="small"> &copy; 2022 - 2024.</p>
        </section>
    </footer>
</body>
</html>
