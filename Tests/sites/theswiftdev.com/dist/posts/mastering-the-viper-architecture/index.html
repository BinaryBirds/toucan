<!DOCTYPE html>
<html >
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Mastering the VIPER architecture - </title>
    <meta name="description" content="Learn how to master the VIPER architectural design pattern, with some protocol oriented programming techniques using Swift.">
    
    <meta property="og:url" content="/posts/mastering-the-viper-architecture/">
    <meta property="og:title" content="Mastering the VIPER architecture - ">
    <meta property="og:description" content="Learn how to master the VIPER architectural design pattern, with some protocol oriented programming techniques using Swift.">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Mastering the VIPER architecture - ">
    <meta name="twitter:description" content="Learn how to master the VIPER architectural design pattern, with some protocol oriented programming techniques using Swift.">
    
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <link rel="shortcut icon" href="/images/icons/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/images/icons/icon-320.png" type="image/png">
    
    <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon-180x180.png">

</head>

<body>
    <header id="navigation">
        <a id="site-logo" href="">
            <figure>
                <picture>
                    <source
                        srcset="/images/logos/logo~dark.png"
                        media="(prefers-color-scheme: dark)"
                    >
                    <img
                        id="logo-image"
                        src="/images/logos/logo.png"
                        alt="Logo of "
                        title=""
                    >
                </picture>
            </figure>
        </a>
    
        <nav id="primary-menu">
            <input type="checkbox" id="primary-menu-button" name="menu-button" class="menu-button">
            <label for="primary-menu-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </label>
            <div class="menu-items">
                <a href="/">Home</a>
                <a href="/blog/">Blog</a>
                <a href="/posts/pages/1/">Posts</a>
                <a href="/authors/">Authors</a>
                <a href="/tags/">Tags</a>
                <a href="/my-page/">My page</a>
            </div>
        </nav>
    
        <nav id="secondary-menu">
            <input type="checkbox" id="secondary-menu-button" name="menu-button" class="menu-button">
            <label for="secondary-menu-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="1"></circle>
                    <circle cx="12" cy="5" r="1"></circle>
                    <circle cx="12" cy="19" r="1"></circle>
                </svg>
            </label>
            <div class="menu-items right">
                <a href="#">My account</a>
                <a href="/">Logout</a>
            </div>
        </nav>
    </header>
        
    <main>

<article>
    <header>
        <section id="post-header" class="content-wrapper">
            <time datetime="2019-03-19 16:20:00">2019-03-19 16:20:00</time>
            <h1 class="title">Mastering the VIPER architecture</h1>
            <p class="excerpt">Learn how to master the VIPER architectural design pattern, with some protocol oriented programming techniques using Swift.</p>
        </section>
        
    </header>

    <section id="contents" class="content-wrapper">
    
    <p>After writing <a href="https://theswiftdev.com/2019/03/11/viper-best-practices-for-ios-developers/" target="_blank">my best practices article about VIPER</a>, I‚Äôve made a few changes to the codebase. I was playing with these ideas in my mind already, but never had enough time to implement them properly. Let‚Äôs me show you the changes‚Ä¶</p><h2>VIPER protocols</h2><p>My generic issue was that I wanted to have a <a href="https://github.com/CoreKit/VIPER" target="_blank">common interface</a> for every single module component. That‚Äôs why I created simple protocols for the following:</p><ul><li>View</li><li>Interactor</li><li>Presenter</li><li>Entity</li><li>Router</li><li>Module</li></ul><p>This way for example my router objects are implementing the Router protocol, so if I make an extension on it, every single one will have that particular functionality. It‚Äôs a pretty small, but very pleasant addition that makes my modules way more powerful than they were before. Honestly speaking I should have had this from the very beginning, but anyway from now on it‚Äôs gona be like this. üò¨</p><p>This move implied to organize my VIPER protocols into a custom framework, so I made one, with these components. You can find it on <a href="https://github.com/CoreKit/VIPER" target="_blank">GitHub</a>, it‚Äôs a really basic one, feel free to use it, you just have to import VIPER in your project.</p><h2>Module protocols</h2><p>Since I was using VIPER it had this great urge to implement a custom module for presenting system default alert messages on iOS. You know <a href="https://developer.apple.com/documentation/uikit/uialertcontroller" target="_blank">UIAlertController</a> is the one I‚Äôm talking about. Actually <a href="https://github.com/Ragnalorn" target="_blank">Robi</a> (my <a href="https://www.youtube.com/watch?v=voxtdphvP5k" target="_blank">true metal</a> friend) suggested a surprisingly nice general solution for the problem. His idea sounded like this:</p><blockquote><p>Why don‚Äôt we create a protocol for the router, so we could implement this on every other router, also we could simply call show(alert:) on them?</p></blockquote><p>I loved this approach, so we‚Äôve built it. Turned out, it‚Äôs freakin awesome. So we introduced a new protocol for the module router, implemented a default protocol extension and voil√† routers are now capable of presenting error messages.</p><p>Note that you can use the same pattern for lots of other (similar) things as well. The basic implementation looks like this one below, I hope you get the idea. üí°</p><pre><code class="language-swift">import VIPER

class AlertModule: Module {
    /* ... */
}

protocol AlertModuleRouter: class {

    func show(alert: AlertEntity)
}

extension AlertModuleRouter where Self: Router {

    func show(alert: AlertEntity) {
        /* ... */
    }
}

// MARK: - other module

protocol MyModuleRouter: Router, AlertModuleRouter {

    // show(alert:) is now available from this router too
}
</code></pre><p>Of course this technique can work for other VIPER components as well, it‚Äôs quite easy to implment and the protocol oriented approach gives us a huge win. üèÜ</p><h2>Presenter to presenter interactions</h2><p>I also changed my mind about the place of the delegate implementations participating in the module communication flow. In my last article I told you that I‚Äôm storing the delegate on the router, but later on I realized that delegation is mostly related to business logic, so I simply moved them to the presenter layer. Sorry about this. ü§∑‚Äç‚ôÇÔ∏è</p><pre><code class="language-swift">import VIPER

protocol AModulePresenterDelegate {
    func didDoSomething()
}

class AModule: Module {

    func build(with delegate: AModulePresenterDelegate? = nil) -> UIViewController {
        // insert classic viper stuff here

        presenter.delegate = delegate

        /* ... */

        return view
    }
}

class AModulePresenter: Presenter {

    func someAction() {
        self.delegate?.didDoSomething()
        self.router?.dismiss()
    }
}

// MARK: - other module

class BModulePresenter: Presenter, AModulePresenterDelegate {

    func didDoSomething() {
        print("Hello from module A!")
    }
}
</code></pre><p>This way you can skip the entire router layer, plus all the business related logic will be implemented in the presenter layer, which should be the only way to go. ü§™</p><h2>Entities are here to stay</h2><p>Apart from the service layer sometimes it‚Äôs quite useful to have an entity wrapper with some additional metadata for the model objects. That‚Äôs why I also made an Entity protocol, and started to use it in my modules. For example a web view module that can open a link can have a WebViewEntity with a title and a content URL property. üòÖ</p><pre><code class="language-swift">import VIPER

struct AlertEntity: Entity {
    let title: String
    let message: String
}
</code></pre><p>The sample alert module from above can use an AlertEntity with some properties that can define the title, message or the buttons. This way you don‚Äôt really have to think about where to put those objects, because those are the real VIPER entities.</p><h2>IO protocols</h2><p>This is a WIP (work-in-progress) idea that I‚Äôd like to try out, but the basic concept is somewhat like that I want to separate input and output protocols for VIPER module layers. Also this IO differentiation can be reflected on the service layers too (maybe the whole object ‚Äúmess‚Äù from the service layer is going to be used as IO entities in the future), by mess I mean that there can be way too many objects in the Service/Objects directory, so this means that those could be also grouped by modules (aka. entities).</p><p>Anyway, I‚Äôm thinking of something like RequestEntity, ResponseEntity for service communication, and for the VIPER layer communication I could imagine two separate protocols, e.g. PresenterInput, PresenterOutput. We‚Äôll see, but at first sight, it‚Äôs seems like quite an over-engineered thing (hahaha, says the VIPER advocate üòÇ).</p><h2>VIPER vs [put your architecture name here]</h2><p>No! Please don‚Äôt think that x is better than y. Architectures and design patterns are simple tools that can be utilized to make your life more easy. If you don‚Äôt like x, you should try y, but you should not blame x, just because that‚Äôs your personal opinion.</p><p>My current favorite architecture is VIPER, so what? Maybe in a year or two I‚Äôll go crazy in love with reactive programming. Does it really matters? I don‚Äôt think so. I‚Äôve learned and tried so many things during the past, that I can‚Äôt even remember. üß†</p><p>I‚Äôm also constantly trying to figure out new things, as you can see this whole <a href="https://theswiftdev.com/2018/03/12/the-ultimate-viper-architecture-tutorial/" target="_blank">series of articles about VIPER</a> is the result of my learning progress & experiences. If you really want to master something, you should practice, research and try a lot, and most importantly be proud of your successes and stay humble at the same time. üôè</p><p>That‚Äôs it about the VIPER architecture for a while. I hope you enjoyed reading the whole series. If you have any questions, feel free to ask me through Twitter. üí≠</p>
        
    </section>
    
    <h2>Next</h2>
    
    <h2>Prev</h2>
        <div class="post card">
            <a href="/posts/hummingbird-routing-and-requests/" target="">
                <figure>
                    <picture>
                        <img
                            src=""
                            alt=""
                            title=""
                        >
                    </picture>
                </figure>
                <section>
                    <time datetime="2023-03-17 16:20:00">2023-03-17 16:20:00</time>
                    <h2 class="title">Hummingbird routing and requests</h2>
                </section>
                <p>Beginner&#39;s guide to learn all about routing and request handling using the Hummingbird server-side Swift framework.</p>
            </a>
        
            
            
        
        </div>
    
    <h2>Related</h2>
    Empty.
    
    <h2>More by author(s)</h2>
    Empty.

</article>

    </main>

    <footer id="page-footer">
        <section class="content-wrapper">
            <figure>
                <picture>
                    <source
                        srcset="/images/logos/logo~dark.png"
                        media="(prefers-color-scheme: dark)"
                    >
                    <img
                        id="logo-image"
                        src="/images/logos/logo.png"
                        alt="Logo of "
                        title=""
                    >
                </picture>
            </figure>
    
            <p>This site was generated using the <a href="https://swift.org/" target="_blank">Swift</a> programming language.</p>
            
            <p>
                <a href="https://binarybirds.com/">Home</a> ¬∑
                <a href="mailto:binarybirdsofficial@gmail.com">Email</a> ¬∑
                <a href="https://github.com/binarybirds/">GitHub</a> ¬∑
                <a href="https://x.com/tiborbodecs">Twitter</a> ¬∑
                <a href="/rss.xml" target="_blank">RSS</a> ¬∑
                <a href="/sitemap.xml" target="_blank">Sitemap</a>
            </p>
    
            <p class="small"> &copy; 2022 - 2024.</p>
        </section>
    </footer>
</body>
</html>
